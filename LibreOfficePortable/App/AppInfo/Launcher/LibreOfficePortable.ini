[Launch]
ProgramExecutable=libreoffice\program\soffice.exe
MinOS=7
DirectoryMoveOK=yes
SupportsUNC=yes

[Activate]
Java=find
XML=true
Registry=true

[Environment]
PATH=%PAL:AppDir%\libreoffice\program;%PATH%

[FileWrite1]
Type=ini
File=%PAL:AppDir%\libreoffice\program\bootstrap.ini
Section=ErrorReport
Key=ErrorReportServer
Value=

[FileWrite2]
Type=ini
File=%PAL:AppDir%\libreoffice\program\bootstrap.ini
Section=Bootstrap
Key=UserInstallation
Value=$ORIGIN/../../../Data/settings

[FileWrite3]
File=%PAL:DataDir%\settings\user\config\javasettings_Windows_x86.xml
Type=Replace
Find=%PAL:LastDrive%%PAL:LastPackagePartialDir:ForwardSlash%/
Replace=%PAL:Drive%%PAL:PackagePartialDir:ForwardSlash%/

[FileWrite4]
File=%PAL:DataDir%\settings\user\config\javasettings_Windows_x86.xml
Type=Replace
Find=%PAL:LastPortableAppsBaseDir:ForwardSlash%/
Replace=%PAL:LastPortableAppsBaseDir:ForwardSlash%/

[FileWrite5]
File=%PAL:DataDir%\settings\user\config\javasettings_Windows_x86.xml
Type=XML text
XPath=/java/javaInfo/location
Value=file:///%JAVA_HOME_FORWARDSLASH%

[FileWrite6]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=XML text
XPath=//item[normalize-space(@oor:path)="/org.openoffice.Office.Paths/Paths/org.openoffice.Office.Paths:NamedPath['Temp']"]/prop/value
Value=file:///%TEMP:ForwardSlash%/temp

[FileWrite7]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=Replace
Find=DEFAULT--WORK--PATH
Replace=file:///%PortableApps.comDocuments:ForwardSlash%

[FileWrite8]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=Replace
Find=file:///%PAL:LastDrive%%PAL:LastPackagePartialDir:ForwardSlash%
Replace=file:///%PAL:Drive%%PAL:PackagePartialDir:ForwardSlash%

[FileWrite9]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=Replace
Find=file:///PAL:LastPortableAppsBaseDir:ForwardSlash%
Replace=file:///PAL:PortableAppsBaseDir:ForwardSlash%

[FileWrite10]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=Replace
Find=file:///%PAL:LastDrive%/
Replace=file:///%PAL:Drive%/

[FileWrite11]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=Replace
Find=`oor:path="/org.openoffice.Office.Update/Update"><prop oor:name="Enabled" oor:op="fuse"><value>true`
Replace=`oor:path="/org.openoffice.Office.Update/Update"><prop oor:name="Enabled" oor:op="fuse"><value>false`

[FileWrite12]
File=%PAL:DataDir%\settings\user\registrymodifications.xcu
Type=Replace
Find=`oor:path="/org.openoffice.Office.Common/Misc"><prop oor:name="PerformFileExtCheck" oor:op="fuse"><value>true`
Replace=`oor:path="/org.openoffice.Office.Common/Misc"><prop oor:name="PerformFileExtCheck" oor:op="fuse"><value>false`

[FileWrite13]
Type=ini
File=%PAL:AppDir%\libreoffice\program\setup.ini
Section=Bootstrap
Key=BASISINSTALLLOCATION
Value=%PAL:AppDir%\libreoffice\

[FileWrite14]
Type=ini
File=%PAL:AppDir%\libreoffice\program\setup.ini
Section=Bootstrap
Key=INSTALLLOCATION
Value=%PAL:AppDir%\libreoffice\

[FileWrite15]
Type=ini
File=%PAL:AppDir%\libreoffice\program\setup.ini
Section=Bootstrap
Key=OFFICEINSTALLLOCATION
Value=%PAL:AppDir%\libreoffice\

[FileWrite16]
Type=ini
File=%PAL:AppDir%\libreoffice\program\setup.ini
Section=Bootstrap
Key=UREINSTALLLOCATION
Value=%PAL:AppDir%\libreoffice\URE\\
